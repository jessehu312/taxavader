/**
 * @license
 * @file main.js for Finance calculator
 * @copyright Jesse Hu 2021 - All rights reserved.
 */
(()=>{let e=0,t=0,n=0,a=0,r=0,d=0,c=0,o=0,l=0,m=0,u="S";const s={S:[[0,9875,.1],[9876,40125,.12],[40126,85525,.22],[85526,163300,.24],[163301,207350,.32],[207351,518400,.34],[518401,Number.MAX_VALUE,.37]],MFJ:[[0,19750,.1],[19751,80250,.12],[80251,171050,.22],[171051,326600,.24],[326601,414700,.32],[414701,622050,.35],[622051,Number.MAX_VALUE,.37]],MFS:[[0,9875,.1],[9876,40125,.12],[40126,85525,.22],[85526,163300,.24],[163301,207350,.32],[207351,311025,.35],[311026,Number.MAX_VALUE,.27]],HH:[[0,14100,.1],[14101,53700,.12],[53701,85500,.22],[85501,163300,.24],[163301,207350,.32],[207351,518401,.35],[518401,Number.MAX_VALUE,.37]]};calcTaxes=e=>{e=Math.round(e),tax=0,brackets=s[u],console.log(brackets);for(const t of brackets){if([bracketStart,bracketEnd,bracketRate]=t,e<=bracketEnd){tax+=(e-bracketStart)*bracketRate,console.log(tax,(e-bracketStart)*bracketRate);const t=100*bracketRate+"%";return{tax:Math.round(tax),taxPercent:t}}tax+=(bracketEnd-bracketStart)*bracketRate,console.log(tax,(bracketEnd-bracketStart)*bracketRate)}return{tax:0,taxPercent:0}},(()=>{let e=document.getElementById("FilingStatusSelectGrid");window.updateFilingStatus=()=>{u=e.value,console.log(u),calcTotalIncome()}})(),window.calcTotalIncome=()=>{console.info("Adjusted Income Projected ="+(d-c));const a=calcTaxes(e-t),i=calcTaxes(d-c);n=a.tax,o=i.tax,r=a.taxPercent,m=i.taxPercent,updateSummary()},(()=>{let u=document.getElementById("summaryTable");summaryCalcs={1:t=>{t.children[1].innerText=e,t.children[2].innerText=d},2:e=>{e.children[1].innerText=t,e.children[2].innerText=c},3:n=>{n.children[1].innerText=Math.max(e-t,0),n.children[2].innerText=Math.max(d-c,0)},5:e=>{e.children[1].innerText=n,e.children[2].innerText=o},6:e=>{e.children[1].innerText=a,e.children[2].innerText=l},7:e=>{e.children[1].innerText=n-a,e.children[2].innerText=o-l},8:e=>{e.children[1].innerText=r,e.children[2].innerText=m},9:t=>{t.children[1].innerText=0===e?0:Math.round(100*n/e)+"%",t.children[2].innerText=0===d?0:Math.round(100*o/d)+"%"}},window.updateSummary=()=>{for(rows=u.getElementsByTagName("tr"),i=0;i<rows.length;i++)i in summaryCalcs&&summaryCalcs[i](rows[i])}})(),(()=>{let t=document.getElementById("incomeRate"),n=document.getElementById("incomePeriod"),a=document.getElementById("incomePeriodRemaining"),r=document.getElementById("incomeYTD"),c=document.getElementById("incomeProjected");window.calcProjectedIncome=()=>{rate=parseInt(t.value),period=parseInt(n.value),periodsRemaining=parseInt(a.value),ytd=parseInt(r.value),console.info("calculating",rate,period,periodsRemaining,ytd),d=rate*periodsRemaining+ytd,c.value=d,console.info(rate*period+ytd,c),e=ytd,calcTotalIncome()}})(),(()=>{let e=document.getElementById("deductionRate"),n=document.getElementById("deductionPeriod"),a=document.getElementById("deductionPeriodRemaining"),r=document.getElementById("deductionYTD"),d=document.getElementById("deductionProjected");window.calcProjectedDeductions=()=>{rate=parseInt(e.value),period=parseInt(n.value),periodsRemaining=parseInt(a.value),ytd=parseInt(r.value),console.info("calculating",rate,period,periodsRemaining,ytd),c=rate*periodsRemaining+ytd,d.value=c,console.info(rate*period+ytd,d),t=ytd,calcTotalIncome()}})(),(()=>{let e=document.getElementById("withholdRate"),t=document.getElementById("withholdPeriod"),n=document.getElementById("withholdPeriodRemaining"),r=document.getElementById("withholdYTD"),d=document.getElementById("withholdProjected");window.calcProjectedWithhold=()=>{rate=parseInt(e.value),period=parseInt(t.value),periodsRemaining=parseInt(n.value),ytd=parseInt(r.value),console.info("calculating",rate,period,periodsRemaining,ytd),l=rate*periodsRemaining+ytd,d.value=l,console.info(rate*period+ytd,d),a=ytd,updateSummary()}})(),calcProjectedIncome(),calcProjectedDeductions(),updateSummary()})();